@using System.Globalization
@model TravelSummaryViewModel

@{
    CultureInfo culture = CultureInfo.GetCultureInfo("es-ES");
    string startDate = Model.StartDate.ToString("dd MMM yyyy", culture);
    string endDate = Model.EndDate.ToString("dd MMM yyyy", culture);
    string totalCost = string.Format(culture, "{0:N2} {1}", Model.TotalCost, Model.Currency);
    string initialBudget = string.Format(culture, "{0:N2} {1}", Model.InitialBudget, Model.Currency);
    string budgetDifference = string.Format(culture, "{0:N2} {1}", Model.BudgetDifference, Model.Currency);
    bool overBudget = Model.BudgetDifference > 0m;
}

<div class="space-y-10">
    <header class="space-y-6 rounded-3xl border border-white/10 bg-gradient-to-br from-brand-600/20 via-slate-900/80 to-slate-950/90 p-8 shadow-glow">
        <div class="flex flex-col gap-6 lg:flex-row lg:items-center lg:justify-between">
            <div class="space-y-2">
                <p class="text-xs uppercase tracking-[0.3em] text-brand-300/80">Detalle del viaje</p>
                <h1 class="text-4xl font-bold text-white">@Model.Title</h1>
                <p class="text-sm text-slate-200">@Model.Destination · @startDate — @endDate</p>
            </div>
            <div class="grid gap-3 text-xs font-semibold text-slate-200 sm:grid-cols-2 lg:grid-cols-3">
                <span class="rounded-full border border-white/10 px-4 py-2 text-center text-slate-300">Estado: <span class="text-white">@Model.CurrentStatus</span></span>
                <span class="rounded-full border border-white/10 px-4 py-2 text-center text-slate-300">Duración: <span class="text-white">@Model.DurationDays días</span></span>
                <span class="rounded-full border border-white/10 px-4 py-2 text-center text-slate-300">Actividades: <span class="text-white">@Model.ActivitiesCount</span></span>
            </div>
        </div>

        <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
            <div class="rounded-2xl border border-white/10 bg-slate-950/60 p-5">
                <p class="text-xs uppercase tracking-widest text-slate-500">Presupuesto inicial</p>
                <p class="mt-2 text-3xl font-semibold text-white">@initialBudget</p>
                <p class="text-xs text-slate-400">Estimación que definiste al crear el viaje</p>
            </div>
            <div class="rounded-2xl border border-white/10 bg-slate-950/60 p-5">
                <p class="text-xs uppercase tracking-widest text-slate-500">Gasto acumulado</p>
                <p class="mt-2 text-3xl font-semibold text-brand-200">@totalCost</p>
                <p class="text-xs @(overBudget ? "text-red-300" : "text-emerald-300")">@(overBudget ? "Sobre presupuesto" : "Bajo presupuesto")</p>
            </div>
            <div class="rounded-2xl border border-white/10 bg-slate-950/60 p-5">
                <p class="text-xs uppercase tracking-widest text-slate-500">Diferencia</p>
                <p class="mt-2 text-3xl font-semibold @(overBudget ? "text-red-300" : "text-emerald-300")">@budgetDifference</p>
                <p class="text-xs text-slate-400">Comparación entre presupuesto y gasto real</p>
            </div>
            <div class="rounded-2xl border border-white/10 bg-slate-950/60 p-5">
                <p class="text-xs uppercase tracking-widest text-slate-500">Progreso</p>
                <p class="mt-2 text-3xl font-semibold text-white">@Model.ProgressPercentage%</p>
                <div class="mt-3 h-2 rounded-full bg-slate-800">
                    <div class="h-full rounded-full bg-brand-500" style="width: @Model.ProgressPercentage%"></div>
                </div>
            </div>
        </div>

        <div class="grid gap-4 md:grid-cols-3">
            <a href="#actividades" class="flex items-center justify-between rounded-2xl border border-brand-500/40 bg-slate-950/60 px-5 py-4 text-sm font-semibold text-brand-100 transition hover:border-brand-500 hover:text-white">
                <span class="flex items-center gap-2">
                    <i data-lucide="mountain" class="size-4"></i>
                    Añadir actividad
                </span>
                <i data-lucide="arrow-right" class="size-4"></i>
            </a>
            <a href="#alojamiento" class="flex items-center justify-between rounded-2xl border border-brand-500/40 bg-slate-950/60 px-5 py-4 text-sm font-semibold text-brand-100 transition hover:border-brand-500 hover:text-white">
                <span class="flex items-center gap-2">
                    <i data-lucide="hotel" class="size-4"></i>
                    Gestionar alojamiento
                </span>
                <i data-lucide="arrow-right" class="size-4"></i>
            </a>
            <a href="#restaurantes" class="flex items-center justify-between rounded-2xl border border-brand-500/40 bg-slate-950/60 px-5 py-4 text-sm font-semibold text-brand-100 transition hover:border-brand-500 hover:text-white">
                <span class="flex items-center gap-2">
                    <i data-lucide="utensils-crossed" class="size-4"></i>
                    Explorar restaurantes
                </span>
                <i data-lucide="arrow-right" class="size-4"></i>
            </a>
        </div>
    </header>

    <section id="actividades" class="space-y-6 rounded-3xl border border-white/10 bg-slate-900/70 p-8 shadow-lg">
        <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
                <h2 class="text-lg font-semibold text-white">Próximas actividades</h2>
                <p class="text-sm text-slate-400">Consulta la agenda y añade nuevas experiencias para tu viaje.</p>
            </div>
            <a href="#" class="inline-flex items-center gap-2 rounded-full border border-brand-500/60 px-4 py-2 text-xs font-semibold text-brand-100 transition hover:border-brand-500 hover:text-white">
                <i data-lucide="plus" class="size-4"></i>
                Crear actividad
            </a>
        </div>
        <div class="grid gap-4 lg:grid-cols-2">
            @if (!Model.UpcomingEvents.Any())
            {
                <div class="lg:col-span-2">
                    <div class="flex flex-col items-center justify-center gap-3 rounded-2xl border border-dashed border-white/10 bg-slate-950/50 px-6 py-12 text-center">
                        <i data-lucide="calendar" class="size-10 text-slate-500"></i>
                        <p class="text-sm text-slate-400">Todavía no tienes actividades programadas. Empieza agregando la primera para verlas aquí.</p>
                    </div>
                </div>
            }
            else
            {
                @foreach (UpcomingEventViewModel upcoming in Model.UpcomingEvents)
                {
                    string eventDate = upcoming.Date.ToString("dd MMM", culture);
                    string startTime = upcoming.StartTime.ToString("HH:mm", culture);
                    string endTime = upcoming.EndTime.ToString("HH:mm", culture);
                    string cost = string.Format(culture, "{0:N2} {1}", upcoming.Cost, Model.Currency);

                    <article class="space-y-3 rounded-2xl border border-white/10 bg-slate-950/60 p-5">
                        <div class="flex items-center justify-between text-xs text-slate-400">
                            <span>@eventDate</span>
                            <span>@startTime — @endTime</span>
                        </div>
                        <h3 class="text-base font-semibold text-white">@upcoming.Title</h3>
                        <p class="text-xs text-brand-200">Coste estimado: @cost</p>
                        <div class="flex gap-2 text-xs text-slate-300">
                            <button type="button" class="flex-1 rounded-full border border-white/10 px-3 py-1.5 transition hover:border-brand-500 hover:text-brand-200">Editar</button>
                            <button type="button" class="flex-1 rounded-full border border-red-500/40 px-3 py-1.5 text-red-200 transition hover:border-red-500 hover:text-red-100">Eliminar</button>
                        </div>
                    </article>
                }
            }
        </div>
    </section>

    <section id="alojamiento" class="grid gap-6 lg:grid-cols-2">
        <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-8 shadow-lg">
            <h2 class="text-lg font-semibold text-white">Alojamiento</h2>
            <p class="text-sm text-slate-400">Mantén la información de tu hospedaje siempre actualizada.</p>
            <dl class="mt-6 space-y-4 text-sm text-slate-300">
                <div>
                    <dt class="text-xs uppercase tracking-widest text-slate-500">Nombre</dt>
                    <dd class="mt-1 text-base font-semibold text-white">@Model.LodgingName</dd>
                </div>
                <div>
                    <dt class="text-xs uppercase tracking-widest text-slate-500">Tarifa por noche</dt>
                    <dd class="mt-1 text-base font-semibold text-white">@string.Format(culture, "{0:N2} {1}", Model.LodgingNightlyRate, Model.Currency)</dd>
                </div>
            </dl>
            <div class="mt-6 flex flex-wrap gap-2 text-xs font-semibold">
                <a href="#" class="rounded-full border border-brand-500/60 px-4 py-2 text-brand-100 transition hover:border-brand-500 hover:text-white">Actualizar datos</a>
                <a href="#" class="rounded-full border border-white/10 px-4 py-2 text-slate-300 transition hover:border-brand-500 hover:text-brand-200">Añadir reserva</a>
            </div>
        </div>
        <div id="restaurantes" class="space-y-6 rounded-3xl border border-white/10 bg-slate-900/70 p-8 shadow-lg">
            <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
                <div>
                    <h2 class="text-lg font-semibold text-white">Restaurantes recomendados</h2>
                    <p class="text-sm text-slate-400">Guarda tus lugares favoritos para comer durante el viaje.</p>
                </div>
                <a href="#" class="inline-flex items-center gap-2 rounded-full border border-brand-500/60 px-4 py-2 text-xs font-semibold text-brand-100 transition hover:border-brand-500 hover:text-white">
                    <i data-lucide="plus" class="size-4"></i>
                    Agregar restaurante
                </a>
            </div>
            <div class="space-y-4 text-sm text-slate-400">
                <p>Aún no has añadido recomendaciones gastronómicas. Empieza creando una lista con horarios y presupuestos estimados para cada comida.</p>
            </div>
        </div>
    </section>
</div>
